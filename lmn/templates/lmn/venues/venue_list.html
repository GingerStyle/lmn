{% extends 'lmn/base.html' %}
{% block content %}

<h2>Venue List</h2>

<div>
    <P>Venue Search</P>

    <form id="search" method="POST" action="{% url 'lmn:venue_list' %}">
        {% csrf_token %}
        <input type="text" class="form-control" id="txtSearch" name="search_name">
        <input type="submit" value="Search"  class="btn btn-default btn-submit submit-search">
    </form>

    <script>
     // Code for much of this autocomplete functionality at
     // https://medium.com/@ninajlu/django-ajax-jquery-search-autocomplete-d4b4bf6494dd
     $(document).ready(function() {
         $("#txtSearch").autocomplete({
             source: "/ajax_calls/search/",
             minLength: 2,
             open: function() {
                 setTimeout(function() {
                     $('.ui-autocomplete').css('z-index', 99);
                 }, 0);
             }
         });

         // $(".submit-search").on('click', function() {
         //    $.post(
         //        url='venues/list/',
         //        data={
        //             search_name: $('#txtSearch').val()
        //         }
       //      )
      //   }); 
     });
    </script>
    <!-- The form fields are built from the definition in forms.py -->
    <!-- <form action="{% url 'lmn:venue_list' %}"> -->
       <!-- {{ form }} -->
        <!-- <input type='submit' value='Search'/>  -->
</form>
</div>



{% if search_term %}
  <h2 id="venue_list_title">Venues matching '{{ search_term }}'  <a href="{% url 'lmn:venue_list' %}" id='clear_search'>clear</a></h2>
{% else %}
  <h2 id="venue_list_title">All venues</h2>
{% endif %}

<div>

{% for venue in venues %}

<div id="venue_{{ venue.pk }}">
  <P><a href="{% url 'lmn:venue_detail' venue_pk=venue.pk %}">{{ venue.name }}</a>
  {{ venue.city }}, {{ venue.state }}</p>
  <P>See artists, notes, and add your own <a href='{% url "lmn:artists_at_venue" venue_pk=venue.pk %}'>{{ venue.name }} notes</a>
</p>
</div>

{% empty %}
  <P>No venues found</p>
{% endfor %}

</div>

{% endblock %}
